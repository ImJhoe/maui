<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="CitasMedicasApp.Views.MainMenuPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:CitasMedicasApp.ViewModels"
             x:DataType="vm:MainMenuViewModel"
             Title="{Binding Title}">

    <Grid RowDefinitions="Auto,*,Auto" Padding="20">

        <!-- Header con información del usuario -->
        <Frame Grid.Row="0" 
               BackgroundColor="{AppThemeBinding Light=#E8F5E8, Dark=#1B4D1B}"
               HasShadow="True" 
               CornerRadius="10" 
               Padding="20"
               Margin="0,0,0,20">
            <StackLayout Spacing="10">
                <Label Text="{Binding WelcomeMessage}" 
                       FontSize="18" 
                       FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light=#2E7D32, Dark=#4CAF50}" />
                <Label Text="{Binding CurrentUser.NombreRol, StringFormat='Rol: {0}'}" 
                       FontSize="14" 
                       TextColor="{AppThemeBinding Light=#1B5E20, Dark=#66BB6A}" />
                <Label Text="{Binding CurrentUser.Correo, StringFormat='Email: {0}'}" 
                       FontSize="12" 
                       TextColor="{AppThemeBinding Light=#388E3C, Dark=#81C784}" />
            </StackLayout>
        </Frame>

        <!-- Menú de opciones -->
        <ScrollView Grid.Row="1">
            <StackLayout Spacing="15">

                <!-- Historial Clínico -->
                <Frame IsVisible="{Binding CanAccessHistorial}" 
                       BackgroundColor="{AppThemeBinding Light=White, Dark=#333}"
                       HasShadow="True" 
                       CornerRadius="10" 
                       Padding="0">
                    <Grid ColumnDefinitions="Auto,*,Auto" Padding="20">
                        <Image Grid.Column="0" 
                              Source="history_icon.png" 
                              HeightRequest="40" 
                              WidthRequest="40" 
                              VerticalOptions="Center" />
                        <StackLayout Grid.Column="1" 
                                    Margin="15,0,0,0" 
                                    VerticalOptions="Center">
                            <Label Text="Historial Clínico" 
                                  FontSize="16" 
                                  FontAttributes="Bold" />
                            <Label Text="Buscar historial por cédula del paciente" 
                                  FontSize="12" 
                                  TextColor="{AppThemeBinding Light=#666, Dark=#999}" />
                        </StackLayout>
                        <Image Grid.Column="2" 
                              Source="arrow_right.png" 
                              HeightRequest="20" 
                              WidthRequest="20" 
                              VerticalOptions="Center" />
                    </Grid>
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding GoToHistorialCommand}" />
                    </Frame.GestureRecognizers>
                </Frame>

                <!-- Consultar Citas -->
                <Frame BackgroundColor="{AppThemeBinding Light=White, Dark=#333}"
                       HasShadow="True" 
                       CornerRadius="10" 
                       Padding="0">
                    <Grid ColumnDefinitions="Auto,*,Auto" Padding="20">
                        <Image Grid.Column="0" 
                              Source="calendar_icon.png" 
                              HeightRequest="40" 
                              WidthRequest="40" 
                              VerticalOptions="Center" />
                        <StackLayout Grid.Column="1" 
                                    Margin="15,0,0,0" 
                                    VerticalOptions="Center">
                            <Label Text="Consultar Citas" 
                                  FontSize="16" 
                                  FontAttributes="Bold" />
                            <Label Text="Buscar citas por especialidad, médico o fechas" 
                                  FontSize="12" 
                                  TextColor="{AppThemeBinding Light=#666, Dark=#999}" />
                        </StackLayout>
                        <Image Grid.Column="2" 
                              Source="arrow_right.png" 
                              HeightRequest="20" 
                              WidthRequest="20" 
                              VerticalOptions="Center" />
                    </Grid>
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding GoToCitasCommand}" />
                    </Frame.GestureRecognizers>
                </Frame>

                <!-- Cambiar Contraseña -->
                <Frame BackgroundColor="{AppThemeBinding Light=White, Dark=#333}"
                       HasShadow="True" 
                       CornerRadius="10" 
                       Padding="0">
                    <Grid ColumnDefinitions="Auto,*,Auto" Padding="20">
                        <Image Grid.Column="0" 
                              Source="lock_icon.png" 
                              HeightRequest="40" 
                              WidthRequest="40" 
                              VerticalOptions="Center" />
                        <StackLayout Grid.Column="1" 
                                    Margin="15,0,0,0" 
                                    VerticalOptions="Center">
                            <Label Text="Cambiar Contraseña" 
                                  FontSize="16" 
                                  FontAttributes="Bold" />
                            <Label Text="Actualizar contraseña de acceso" 
                                  FontSize="12" 
                                  TextColor="{AppThemeBinding Light=#666, Dark=#999}" />
                        </StackLayout>
                        <Image Grid.Column="2" 
                              Source="arrow_right.png" 
                              HeightRequest="20" 
                              WidthRequest="20" 
                              VerticalOptions="Center" />
                    </Grid>
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding CambiarPasswordCommand}" />
                    </Frame.GestureRecognizers>
                </Frame>

            </StackLayout>
        </ScrollView>

        <!-- Botón de cerrar sesión -->
        <Button Grid.Row="2" 
                Text="CERRAR SESIÓN" 
                Command="{Binding LogoutCommand}"
                BackgroundColor="{AppThemeBinding Light=#D32F2F, Dark=#F44336}"
                TextColor="White"
                FontAttributes="Bold"
                FontSize="16"
                HeightRequest="50"
                CornerRadius="25"
                Margin="0,20,0,0" />

    </Grid>

</ContentPage>